!function(t){var e={};function s(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(i,a,function(e){return t[e]}.bind(null,a));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);class i{constructor(t,e,s,i,o){this.container=t||"body",this.state={width:e,height:s,fps:i,debug:o,bgcolor:"rgba(0,0,0,0)",color:"#ff0",font:"1em Arial"},this.entities=[],this.viewport=r.create(this.state.width,this.state.height,this.container),this.context=this.viewport.getContext("2d"),this.loop=new a(this,this.state.fps)}update(t,e){for(var s=0;s<this.entities.length;s++)this.entities[s].update()}render(t,e){t.context.font=t.state.font,t.context.clearRect(0,0,t.state.width,t.state.height),t.context.fillStyle=t.state.bgcolor,t.context.fillRect(0,0,t.state.width,t.state.height),t.context.fillStyle=t.state.color,t.state.debug&&t.context.fillText("fps : "+t.loop.fps,t.state.width-100,50);for(var s=0;s<this.entities.length;s++)this.entities[s].render()}}class a{constructor(t,e){var s={},i=1e3/e,a=window.performance.now(),r={new:{frameCount:0,startTime:a,sinceStart:0},old:{frameCount:0,startTime:a,sineStart:0}},o="new";return s.fps=0,s.main=function(n){s.stopLoop=window.requestAnimationFrame(s.main);var h,c,p=n,l=p-a;if(l>i){for(var u in a=p-l%i,r)++r[u].frameCount,r[u].sinceStart=p-r[u].startTime;h=r[o],s.fps=Math.round(1e3/(h.sinceStart/h.frameCount)*100)/100,c=r.new.frameCount===r.old.frameCount?5*e:10*e,h.frameCount>c&&(r[o].frameCount=0,r[o].startTime=p,r[o].sinceStart=0,o="new"===o?"old":"new"),t.update(t,p),t.render(t,p)}},s.main(),s}}class r{static create(t,e,s){s=document.querySelector(s||"body");var i=document.createElement("canvas"),a=i.getContext("2d"),r=window.devicePixelRatio/["webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio"].reduce(function(t,e){return Object.prototype.hasOwnProperty.call(a,e)?a[e]:1});return i.width=Math.round(t*r),i.height=Math.round(e*r),i.style.width=t+"px",i.style.height=e+"px",a.setTransform(r,0,0,r,0,0),s.insertBefore(i,s.firstChild),i}}class o{constructor(){this.state={size:{x:10,y:10},pos:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},radius:10,angle:0},this.entities=[]}update(){for(var t=0;t<this.entities.length;t++)this.entities[t].update();this.state.vel.x+=this.state.accel.x,this.state.vel.y+=this.state.accel.y,this.state.pos.x+=this.state.vel.x,this.state.pos.y+=this.state.vel.y}render(){for(var t=0;t<this.entities.length;t++)this.entities[t].render()}}class n extends o{constructor(t,e){super(),this.scope=t,this.state.pos=e.pos||{x:0,y:0},this.state.crop={x:0,y:0},this.state.size=e.size||{x:0,y:0},this.state.frames=e.frames||[],this.state.angle=e.angle||0,this.state.image=e.image||new Image,this.state.delay=e.delay||5,this.state.tick=e.tick||0,this.state.orientation=e.orientation||"horizontal"}update(){super.update(),this.state.tick<=0&&("vertical"===this.orientation?(this.state.crop.y=this.state.frames.shift(),this.state.frames.push(this.state.crop.y)):(this.state.crop.x=this.state.frames.shift(),this.state.frames.push(this.state.crop.x)),this.state.tick=this.state.delay),this.state.tick--}render(){super.render(),this.scope.context.save(),this.scope.context.translate(this.state.crop.x+this.state.size.x/2,this.state.crop.y+this.state.size.y/2),this.scope.context.rotate(this.state.angle*(Math.PI/180)),this.scope.context.translate(-(this.state.crop.x+this.state.size.x/2),-(this.state.crop.y+this.state.size.y/2)),this.scope.context.drawImage(this.state.image,this.state.crop.x*this.state.size.x,this.state.crop.y*this.state.size.y,this.state.size.x,this.state.size.y,this.state.pos.x,this.state.pos.y,this.state.size.x,this.state.size.y),this.scope.context.restore()}}class h{static detector(t,e){var s=t.state.pos.x,i=t.state.pos.y,a=s+t.state.size.x,r=i+t.state.size.y,o=e.state.pos.x,n=e.state.pos.y,h=o+e.state.size.x,c=n+e.state.size.y;return!(r<n||i>c||a<o||s>h)}}Number.prototype.boundary=function(t,e){return Math.min(Math.max(this,t),e)};class c extends i{constructor(){super("#container",window.innerWidth,window.innerHeight,60,!1),this.score=0,this.state.color="rgba(255,255,255,1)",this.state.bgcolor="rgba(0,0,0,0.001)",this.state.font="1.5em Arial",this.ball=this.entities.push(new p(this))-1,this.entities.push(new u(this));for(var t=0;t<3;t++)for(var e=0;e<this.state.width/138;e++){var s=this.entities.push(new l(this,{x:138*e,y:53*t}));this.entities[s-1].id=s-1}}render(){super.render(this),this.context.fillText("score: "+this.score,16,50)}}class p extends n{constructor(t){super(t,{frames:[0],image:d.fetch("./media/ball@3X.png")}),this.state.vel={x:5,y:5},this.state.size={x:48,y:48},this.state.pos={x:t.state.width/2-this.state.size.x/2,y:t.state.height/2-this.state.size.y}}update(){super.update(),this.state.pos.y<0&&(this.state.vel.y*=-1),this.state.pos.y+this.state.size.y+69>this.scope.state.height&&(this.state.vel.y*=-1),this.state.pos.x<0&&(this.state.vel.x*=-1),this.state.pos.x+this.state.size.x>this.scope.state.width&&(this.state.vel.x*=-1)}}class l extends n{constructor(t,e){super(t,{frames:[0],image:d.fetch("./media/block@3x.png")}),this.scope=t,this.state.size={x:138,y:53},this.state.pos={x:e.x,y:e.y}}update(){super.update(),h.detector(this.scope.entities[this.scope.ball],this)&&(this.scope.score+=10,this.state.image=new Image,this.state.pos=this.state.size={x:0,y:0})}}class u extends n{constructor(t){super(t,{frames:[0],image:d.fetch("./media/paddle@3X.png")}),this.scope=t,this.state.size={x:180,y:69}}update(){super.update(),this.state.pos={x:this.scope.entities[this.scope.ball].state.pos.x+25-this.state.size.x/2,y:this.scope.state.height-this.state.size.y}}}var d=new class{constructor(){this.rescache={}}load(t,e){var s=this;t instanceof Array?t.forEach(function(t){s.rescache[t]=!1,s.fetch(t,e)}):(s.rescache[t]=!1,s.fetch(t,e))}fetch(t,e){var s=this;if(s.rescache[t])return s.rescache[t];var i=new Image;i.onload=function(){s.rescache[t]=i,s.ready(e)},i.src=t}ready(t){if("function"==typeof t){var e=!0;for(var s in this.rescache)Object.prototype.hasOwnProperty.call(this.rescache,s)&&!this.rescache[s]&&(e=!1);e&&t()}}};d.load(["./media/ball@3X.png","./media/paddle@3X.png","./media/block@3x.png"],function(){window.game=new c})}]);